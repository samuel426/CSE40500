GPT-4.1 ë¬¸ì˜ ê²°ê³¼
BiLSTM_Apple_optimized.har ëª¨ë¸ì˜ ì»´íŒŒì¼ ì‹¤íŒ¨ ì›ì¸ì´ ë¬´ì—‡ì¸ì§€ ì°¾ì•„ ë³´ê³ , í•´ê²°ë°©ì•ˆì„ ì•Œë ¤ ì¤˜

woosangwoo: (hailo_virtualenv) hailo@docker-desktop:~/scripts$ ./compile_to_hef.sh
ğŸš€ [Hailo HEF íŒŒì¼ ì»´íŒŒì¼ ì‹œì‘]
ğŸ”„ Compiling ./compiled_model/optimized/BiLSTM_Apple_optimized.har â†’ ./compiled_model/hef/
[info] Current Time: 22:46:52, 05/18/25
[info] CPU: Architecture: x86_64, Model: AMD Ryzen 9 5900X 12-Core Processor, Number Of Cores: 24, Utilization: 0.1%
[info] Memory: Total: 31GB, Available: 29GB
[info] System info: OS: Linux, Kernel: 5.15.167.4-microsoft-standard-WSL2
[info] Hailo DFC Version: 3.31.0
[info] HailoRT Version: 4.21.0
[info] PCIe: No Hailo PCIe device was found
[info] Running `hailo compiler ./compiled_model/optimized/BiLSTM_Apple_optimized.har --hw-arch hailo8l --output-dir ./compiled_model/hef --model-script performance_param(compiler_optimization_level=max)`
[info] ParsedPerformanceParam command, setting optimization_level(max=2)
[info] Loading model script commands to BiLSTM_Apple from string
[info] ParsedPerformanceParam command, setting optimization_level(max=2)
[info] Compiling network
[info] Loading network parameters
[info] Starting Hailo allocation and compilation flow
[info] Building optimization options for network layers...
[info] Successfully built optimization options - 2s 506ms
[info] Trying to compile the network in a single context
[info] Single context flow failed: Recoverable single context error
[info] Building optimization options for network layers...
[info] Successfully built optimization options - 1s 296ms
[info] Using Multi-context flow
[info] Resources optimization params: max_control_utilization=100%, max_compute_utilization=100%, max_compute_16bit_utilization=100%, max_memory_utilization (weights)=85%, max_input_aligner_utilization=100%, max_apu_utilization=100%
[info] Finding the best partition to contexts...
[..................................<==>..] Elapsed: 00:55:40
[info] Building optimization options for network layers...
[info] Successfully built optimization options - 3s 24ms
[info] Using Multi-context flow
[info] Resources optimization params: max_control_utilization=90%, max_compute_utilization=90%, max_compute_16bit_utilization=90%, max_memory_utilization (weights)=85%, max_input_aligner_utilization=90%, max_apu_utilization=90%
[info] Finding the best partition to contexts...
[...............................<==>.....] Elapsed: 00:51:59
[info] Building optimization options for network layers...
[info] Successfully built optimization options - 3s 166ms
[info] Using Multi-context flow
[info] Resources optimization params: max_control_utilization=80%, max_compute_utilization=80%, max_compute_16bit_utilization=80%, max_memory_utilization (weights)=80%, max_input_aligner_utilization=80%, max_apu_utilization=80%
[info] Finding the best partition to contexts...
[.......<==>.............................] Elapsed: 00:45:56
[info] Building optimization options for network layers...
[info] Successfully built optimization options - 3s 153ms
[info] Using Multi-context flow
[info] Resources optimization params: max_control_utilization=70%, max_compute_utilization=70%, max_compute_16bit_utilization=70%, max_memory_utilization (weights)=70%, max_input_aligner_utilization=70%, max_apu_utilization=70%
[info] Finding the best partition to contexts...
[......................<==>..............] Elapsed: 00:38:14
[info] Building optimization options for network layers...
[info] Successfully built optimization options - 2s 987ms
[info] Using Multi-context flow
[info] Resources optimization params: max_control_utilization=60%, max_compute_utilization=60%, max_compute_16bit_utilization=60%, max_memory_utilization (weights)=60%, max_input_aligner_utilization=60%, max_apu_utilization=60%
[info] Finding the best partition to contexts...
[..........<==>..........................] Elapsed: 00:31:51
[error] Mapping Failed (Timeout, allocation time: 31m 54s)
No valid partition found
Mapping Failed (Timeout, allocation time: 31m 54s)

[error] Failed to produce compiled graph
[error] BackendAllocatorException: Compilation failed: No valid partition found
Mapping Failed (Timeout, allocation time: 31m 54s)
âœ… HEF íŒŒì¼ ì»´íŒŒì¼ ì™„ë£Œ

BiLSTM_Apple_optimized.har ëª¨ë¸ì˜ ì»´íŒŒì¼ ì‹¤íŒ¨ ì›ì¸ì´ ë¬´ì—‡ì¸ì§€ ì°¾ì•„ ë³´ê³ , í•´ê²°ë°©ì•ˆì„ ì•Œë ¤ ì¤˜

GitHub Copilot: ### ì›ì¸ ë¶„ì„

ë¡œê·¸ì—ì„œ ë°˜ë³µì ìœ¼ë¡œ ë‹¤ìŒ ë©”ì‹œì§€ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤:

```
[info] Finding the best partition to contexts...
[error] Mapping Failed (Timeout, allocation time: 31m 54s)
No valid partition found
[error] Failed to produce compiled graph
[error] BackendAllocatorException: Compilation failed: No valid partition found
```

#### ì£¼ìš” ì›ì¸
- **BiLSTM ëª¨ë¸ì´ Hailoì˜ ë¦¬ì†ŒìŠ¤(ë©”ëª¨ë¦¬, ì—°ì‚° ìœ ë‹› ë“±) í•œê³„ë¥¼ ì´ˆê³¼**í•˜ê±°ë‚˜,
- **BiLSTM êµ¬ì¡°(ì–‘ë°©í–¥ LSTM, hidden size, ì‹œí€€ìŠ¤ ê¸¸ì´ ë“±)ê°€ Hailo ì»´íŒŒì¼ëŸ¬ê°€ ì§€ì›í•˜ëŠ” ë²”ìœ„ë¥¼ ë²—ì–´ë‚¨**
- **ì»¨í…ìŠ¤íŠ¸ ë¶„í• (ë©€í‹°ì»¨í…ìŠ¤íŠ¸)ë¡œë„ ì í•©í•œ ë§µí•‘ì„ ì°¾ì§€ ëª»í•¨**
- **ëª¨ë¸ì´ ë„ˆë¬´ í¬ê±°ë‚˜ ë³µì¡í•´ì„œ Hailo ì¹©ì— ì˜¬ë¦´ ìˆ˜ ì—†ìŒ**

---

### í•´ê²° ë°©ì•ˆ

1. **ëª¨ë¸ êµ¬ì¡° ë‹¨ìˆœí™”**
   - **hidden_size, num_layers, seq_len**ì„ ì¤„ì´ì„¸ìš”.
     - ì˜ˆ: hidden_size=4, seq_len=4, num_layers=1 ë“±ìœ¼ë¡œ ì‹¤í—˜
   - ì…ë ¥ feature ìˆ˜(INPUT_SIZE)ë„ ì¤„ì¼ ìˆ˜ ìˆë‹¤ë©´ ì¤„ì´ì„¸ìš”.

2. **ì–‘ë°©í–¥(Bidirectional) ì‚¬ìš© ìµœì†Œí™”**
   - ê°€ëŠ¥í•˜ë‹¤ë©´ BiLSTM ëŒ€ì‹  ë‹¨ë°©í–¥ LSTM ì‚¬ìš©ì„ ê³ ë ¤í•˜ì„¸ìš”.
   - BiLSTMì€ ë¦¬ì†ŒìŠ¤ ì†Œëª¨ê°€ 2ë°°ì…ë‹ˆë‹¤.

3. **ì¶œë ¥ ë ˆì´ì–´(FC) ë‹¨ìˆœí™”**
   - FC ë ˆì´ì–´ì˜ in_features, out_featuresê°€ Hailoì—ì„œ ì§€ì›í•˜ëŠ” ê°’(ì˜ˆ: 4, 8, 16 ë“±)ì¸ì§€ í™•ì¸

4. **ëª¨ë¸ ìµœì í™” ì˜µì…˜ í™œìš©**
   - ì´ë¯¸ `performance_param(compiler_optimization_level=max)`ë¥¼ ì‚¬ìš© ì¤‘ì´ë¯€ë¡œ,  
     ì˜¤íˆë ¤ `basic`ì´ë‚˜ `fast`ë¡œ ë‚®ì¶°ì„œ ì‹œë„í•´ ë³¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

5. **ëª¨ë¸ì„ ë” ì‘ì€ ë‹¨ìœ„ë¡œ ìª¼ê°œì„œ ì—¬ëŸ¬ ëª¨ë¸ë¡œ ë¶„ë¦¬**
   - í•œ ë²ˆì— ì²˜ë¦¬í•˜ëŠ” ì‹œí€€ìŠ¤ ê¸¸ì´, feature ìˆ˜ë¥¼ ì¤„ì—¬ì„œ ì—¬ëŸ¬ ëª¨ë¸ë¡œ ë‚˜ëˆ„ëŠ” ê²ƒë„ ë°©ë²•ì…ë‹ˆë‹¤.

6. **Hailo ê³µì‹ ë¬¸ì„œ/í¬ëŸ¼ í™•ì¸**
   - BiLSTM, LSTM ë“± RNN ê³„ì—´ì€ Hailoì—ì„œ ì œí•œì ìœ¼ë¡œ ì§€ì›ë˜ë¯€ë¡œ,  
     ê³µì‹ ì§€ì› ë²”ìœ„ì™€ ì˜ˆì œ ëª¨ë¸ì„ ì°¸ê³ í•˜ì„¸ìš”.

---

### ì‹¤ì§ˆì  ì¡°ì¹˜ ì˜ˆì‹œ

- **ì˜ˆì‹œ: ëª¨ë¸ êµ¬ì¡° ë‹¨ìˆœí™”**
    ```python
    class BiLSTMModel(nn.Module):
        def __init__(self, input_size=4, hidden_size=4, num_layers=1, output_size=1):
            super().__init__()
            self.bilstm = nn.LSTM(
                input_size=input_size,
                hidden_size=hidden_size,
                num_layers=num_layers,
                batch_first=True,
                bidirectional=True
            )
            self.fc_price = nn.Linear(hidden_size * 2, output_size)
            self.fc_volume = nn.Linear(hidden_size * 2, output_size)
        # ...
    ```
- **ONNX ë³€í™˜ ì‹œ ì…ë ¥ shapeë„ ë§ì¶°ì„œ ì¤„ì´ì„¸ìš”.**

---

### ìš”ì•½

- **BiLSTM ëª¨ë¸ì´ Hailo ì¹©ì˜ ë¦¬ì†ŒìŠ¤ í•œê³„ë¥¼ ì´ˆê³¼**í•´ì„œ ì»´íŒŒì¼ì´ ì‹¤íŒ¨í•œ ê²ƒì…ë‹ˆë‹¤.
- **ëª¨ë¸ì„ ë” ì‘ê³  ë‹¨ìˆœí•˜ê²Œ**(hidden_size, seq_len, num_layers, input_size ë“±) ë§Œë“¤ì–´ì„œ ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”.
- ê·¸ë˜ë„ ì•ˆ ë˜ë©´ ë‹¨ë°©í–¥ LSTMì´ë‚˜ CNN ê¸°ë°˜ ëª¨ë¸ë¡œ ë³€ê²½ì„ ê³ ë ¤í•˜ì„¸ìš”.

**ì°¸ê³ :**  
HailoëŠ” CNN ê¸°ë°˜ ë„¤íŠ¸ì›Œí¬ì— ìµœì í™”ë˜ì–´ ìˆìœ¼ë©°, RNN/BiLSTM ê³„ì—´ì€ ì§€ì›ì´ ë§¤ìš° ì œí•œì ì…ë‹ˆë‹¤.  
ê³µì‹ ë¬¸ì„œì˜ ì§€ì› ëª¨ë¸/ì˜ˆì œë„ ê¼­ ì°¸ê³ í•˜ì„¸ìš”.